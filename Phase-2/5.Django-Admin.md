# **Django Admin Panel: Complete Setup & Customization Tutorial**

## **Objective**
By the end of this tutorial, you'll master Django's admin interface by creating a superuser, registering models, customizing the admin panel, and performing full CRUD operations.

---

## **Prerequisites**
- Working Django project with models
- Migrations applied (`python manage.py migrate`)
- Basic understanding of Django models

---

## **Part 1: Django Admin Setup & Superuser**

### **Step 1: Verify Admin is Enabled**

Check your `settings.py`:
```python
# myproject/settings.py
INSTALLED_APPS = [
    'django.contrib.admin',  # Should be present
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'myapp',  # Your app
]

MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]
```

Also check `urls.py`:
```python
# myproject/urls.py
from django.contrib import admin
from django.urls import path

urlpatterns = [
    path('admin/', admin.site.urls),
    # ... other URLs
]
```

### **Step 2: Create a Superuser**

Run this command:
```bash
python manage.py createsuperuser
```

You'll be prompted for:
```
Username: admin
Email address: admin@example.com
Password: ********
Password (again): ********
Superuser created successfully.
```

**Tips for passwords:**
- Use at least 8 characters
- Mix letters, numbers, and symbols
- Or use a passphrase: `MyDjangoAdmin@2024!`

**Alternative: Non-interactive creation**
```bash
echo "from django.contrib.auth import get_user_model; User = get_user_model(); User.objects.create_superuser('admin', 'admin@example.com', 'password123')" | python manage.py shell
```

### **Step 3: Log into Admin Panel**

1. Start your development server:
   ```bash
   python manage.py runserver
   ```

2. Open your browser and go to:
   ```
   http://127.0.0.1:8000/admin/
   ```

3. Enter the credentials you just created

**What you'll see:**
- Authentication and Authorization section (Users, Groups)
- Your models (once registered)

### **Step 4: Explore the Default Admin**

Before customization, explore:
1. **Users**: Click to see user list, try filtering
2. **Groups**: Permission management
3. **Add new user**: Try creating a regular user
4. **Change password**: Update your own password

**Security Tip:** Change the default admin URL for production:
```python
# urls.py - Change this for security
path('my-secret-admin/', admin.site.urls),
```

---

## **Part 2: Register Models & Customize Admin Panel**

### **Step 5: Basic Model Registration**

In `myapp/admin.py`:
```python
from django.contrib import admin
from .models import Book

# Basic registration
admin.site.register(Book)
```

Refresh admin page - you'll see "Books" section.

### **Step 6: Create Admin Class with Customizations**

Replace basic registration with:
```python
from django.contrib import admin
from .models import Book, Author, Category

# Custom Admin Class
class BookAdmin(admin.ModelAdmin):
    # What to display in list view
    list_display = ('title', 'author', 'price', 'in_stock', 'published_date')
    
    # Clickable fields for editing
    list_display_links = ('title', 'author')
    
    # Add filters on the right sidebar
    list_filter = ('in_stock', 'published_date', 'author')
    
    # Search functionality
    search_fields = ('title', 'author', 'description')
    
    # Enable editing directly from list view
    list_editable = ('price', 'in_stock')
    
    # Pagination
    list_per_page = 25
    
    # Default ordering
    ordering = ('-published_date',)  # Newest first
    
    # Date-based navigation
    date_hierarchy = 'published_date'

# Register with custom class
admin.site.register(Book, BookAdmin)
```

### **Step 7: Customize the Add/Change Form**

```python
class BookAdmin(admin.ModelAdmin):
    # ... previous code ...
    
    # Customize the form layout
    fieldsets = (
        ('Basic Information', {
            'fields': ('title', 'author', 'description'),
            'classes': ('wide', 'extrapretty'),
        }),
        ('Details', {
            'fields': ('price', 'page_count', 'in_stock'),
            'classes': ('collapse',),  # Collapsible section
        }),
        ('Publishing', {
            'fields': ('published_date', 'publisher', 'isbn'),
        }),
    )
    
    # Preview of description (readonly)
    readonly_fields = ('description_preview',)
    
    def description_preview(self, obj):
        return obj.description[:100] + "..." if len(obj.description) > 100 else obj.description
    description_preview.short_description = "Description Preview"
```

### **Step 8: Inline Editing for Related Models**

If you have related models (Author with Books):
```python
# In admin.py
class BookInline(admin.TabularInline):  # or admin.StackedInline
    model = Book
    extra = 1  # Number of empty forms
    fields = ('title', 'price', 'in_stock')
    show_change_link = True

class AuthorAdmin(admin.ModelAdmin):
    list_display = ('name', 'book_count', 'nationality')
    inlines = [BookInline]
    
    def book_count(self, obj):
        return obj.book_set.count()
    book_count.short_description = 'Number of Books'

admin.site.register(Author, AuthorAdmin)
```

### **Step 9: Add Custom Actions**

```python
class BookAdmin(admin.ModelAdmin):
    # ... previous code ...
    
    actions = ['mark_as_sold_out', 'apply_discount']
    
    def mark_as_sold_out(self, request, queryset):
        updated = queryset.update(in_stock=False)
        self.message_user(request, f"{updated} books marked as sold out")
    mark_as_sold_out.short_description = "Mark selected books as sold out"
    
    def apply_discount(self, request, queryset):
        for book in queryset:
            book.price = book.price * 0.9  # 10% discount
            book.save()
        self.message_user(request, f"Applied 10% discount to {queryset.count()} books")
    apply_discount.short_description = "Apply 10% discount"
```

---

## **Part 3: Full CRUD in Django Admin**

### **Step 10: CREATE Operation**

**Method 1: Using "Add" button**
1. Click "Books" → "Add Book" button
2. Fill in the form:
   ```
   Title: The Django Book
   Author: Django Experts
   Price: 39.99
   Published Date: 2024-01-15
   In Stock: ☑ Checked
   ```
3. Click "Save" or:
   - **Save and add another**: Save and open new form
   - **Save and continue editing**: Save and stay on same form

**Method 2: Bulk creation from shell (then view in admin)**
```bash
python manage.py shell
```
```python
from myapp.models import Book
from django.utils import timezone

books = [
    Book(title="Python Crash Course", author="Eric Matthes", price=34.99),
    Book(title="Automate the Boring Stuff", author="Al Sweigart", price=29.99),
    Book(title="Fluent Python", author="Luciano Ramalho", price=44.99),
]
Book.objects.bulk_create(books)
```

### **Step 11: READ/View Operations

**View all records:**
1. Click "Books" in admin
2. Use features:
   - **Search**: Type in search box
   - **Filter**: Use right sidebar filters
   - **Sort**: Click column headers
   - **Select**: Checkboxes for bulk actions

**View single record:**
1. Click any book title (clickable link)
2. See all fields in detail view
3. Notice tabs: "History" shows all changes

### **Step 12: UPDATE Operations

**Method 1: Edit from list view**
1. In book list, edit "Price" or "In Stock" directly
2. Changes save automatically when you click elsewhere

**Method 2: Edit from detail view**
1. Click a book title
2. Modify any field
3. Click:
   - **Save**: Return to list
   - **Save and continue editing**: Stay on page
   - **Save and add another**: New form
   - **Delete**: Remove record

**Method 3: Bulk update with actions**
1. Select multiple books (checkboxes)
2. From "Action" dropdown, select "Apply 10% discount"
3. Click "Go"
4. See confirmation message

### **Step 13: DELETE Operations

**Delete single record:**
1. Go to book detail view
2. Click red "DELETE" button at bottom
3. Confirm deletion on confirmation page

**Bulk delete:**
1. Select multiple books
2. From "Action" dropdown: "Delete selected books"
3. Click "Go"
4. Confirm deletion

**⚠️ Important:** Django shows all related objects that will be deleted too!

### **Step 14: Advanced Admin Customizations

**Custom admin site header:**
```python
# In admin.py
admin.site.site_header = "My Bookstore Administration"
admin.site.site_title = "Bookstore Admin Portal"
admin.site.index_title = "Welcome to Bookstore Admin"
```

**Change app names:**
```python
# In apps.py of your app
from django.apps import AppConfig

class MyappConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'myapp'
    verbose_name = "Book Management"  # Changes display name in admin
```

**Custom templates (advanced):**
```bash
# Create directory structure
mkdir -p templates/admin/myapp/book/

# Copy default template
cp venv/lib/python3.9/site-packages/django/contrib/admin/templates/admin/change_form.html templates/admin/myapp/book/

# Edit the template to customize
```

---

## **Common Pitfalls & Solutions**

### **Pitfall 1: "No module named 'admin'"**
**Solution:** Make sure you created `admin.py` in your app directory, not in project directory.

### **Pitfall 2: Models not appearing in admin**
**Solutions:**
1. Check `admin.py` has `admin.site.register(YourModel)`
2. Verify app is in `INSTALLED_APPS`
3. Restart server: `python manage.py runserver`

### **Pitfall 3: Cannot log in after creating superuser**
**Solutions:**
1. Check you're using correct username (not email)
2. Try: `python manage.py changepassword username`
3. Create new superuser if needed

### **Pitfall 4: Slow admin with many records**
**Optimizations:**
```python
class BookAdmin(admin.ModelAdmin):
    # Add these:
    list_select_related = ('author',)  # Reduce queries
    show_full_result_count = False  # Don't count all records
    # Use autocomplete_fields for foreign keys
    autocomplete_fields = ['author']
```

### **Pitfall 5: Permission errors**
**Debug:** Check user has correct permissions in "Users" section of admin.

---

## **Practice Exercises**

### **Exercise 1: Complete Bookstore Admin**
1. Create these models:
   ```python
   class Category(models.Model):
       name = models.CharField(max_length=100)
       description = models.TextField()
   
   class Author(models.Model):
       name = models.CharField(max_length=100)
       bio = models.TextField()
       website = models.URLField()
   ```
2. Register both with customized admin classes
3. Add `category` ForeignKey to Book model
4. Create inline editing for Books in Category admin

### **Exercise 2: Custom Admin Actions**
Create these actions:
1. "Export selected books to CSV"
2. "Send low stock alert email" (simulated)
3. "Duplicate selected books"

### **Exercise 3: Admin Filters**
Add custom filters:
```python
class PriceRangeFilter(admin.SimpleListFilter):
    title = 'price range'
    parameter_name = 'price'
    
    def lookups(self, request, model_admin):
        return (
            ('0-20', 'Cheap ($0-20)'),
            ('20-50', 'Medium ($20-50)'),
            ('50+', 'Expensive ($50+)'),
        )
    
    def queryset(self, request, queryset):
        # Implement filter logic
        pass
```

---

## **Quick Reference Commands**

```bash
# Superuser management
python manage.py createsuperuser
python manage.py changepassword <username>
python manage.py createsuperuser --username=admin --email=admin@example.com

# Run server
python manage.py runserver
python manage.py runserver 0.0.0.0:8000  # Access from network

# Check admin URLs
python manage.py show_urls | grep admin

# Create initial data
python manage.py loaddata initial_data.json
```

---

## **Admin Customization Cheat Sheet**

```python
# Common ModelAdmin options:
list_display = ()        # Columns in list view
list_filter = ()         # Filters in sidebar
search_fields = ()       # Searchable fields
list_editable = ()       # Editable in list view
ordering = ()            # Default sorting
list_per_page = 100      # Items per page
date_hierarchy = ''      # Date navigation
fieldsets = ()           # Form organization
inlines = []             # Related models inline
actions = []             # Bulk actions
readonly_fields = ()     # Non-editable fields
autocomplete_fields = () # Foreign key search
```

---

